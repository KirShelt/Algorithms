   <div class="header">
      <h1 class="title">E. На санях</h1>
      <table>
         <tbody><tr class="time-limit">
            <td class="property-title">Ограничение времени</td>
            <td>5&nbsp;секунд</td>
         </tr>
         <tr class="memory-limit">
            <td class="property-title">Ограничение памяти</td>
            <td>256Mb</td>
         </tr>
         <tr class="input-file">
            <td class="property-title">Ввод</td>
            <td colspan="1">стандартный ввод или input.txt</td>
         </tr>
         <tr class="output-file">
            <td class="property-title">Вывод</td>
            <td colspan="1">стандартный вывод или output.txt</td>
         </tr>
      </tbody></table>
   </div>
   <div class="legend"><span style="">
         <p>В начале XVIII века еще не было самолетов, поездов и автомобилей, поэтому все междугородние зимние поездки совершались на
            санях. Как известно, с дорогами в России тогда было даже больше проблем, чем сейчас, а именно на N существовавших тогда городов
            имелась N-1 дорога, каждая из которых соединяла два города. Из каждого города можно было добраться в любой другой (возможно,
            через промежуточные города). В каждом городе была почтовая станция («ям»), на которой можно было пересесть в другие сани.
            При этом ямщики могли долго запрягать (для каждого города известно время, которое ямщики в этом городе тратят на подготовку
            саней к поездке) и быстро ехать (также для каждого города известна скорость, с которой ездят ямщики из него). Можно считать,
            что количество ямщиков в каждом городе не ограничено.
         </p></span><p>Если бы олимпиада проводилась 300 лет назад, то путь участников занимал бы гораздо большее время, чем сейчас. Допустим, из
         каждого города в Москву выезжает участник олимпиады и хочет добраться до Москвы за наименьшее время (не обязательно по кратчайшему
         пути: он может заезжать в любые города, через один и тот же город можно проезжать несколько раз). Сначала он едет с ямщиком
         из своего города. Приехав в любой город, он может либо сразу ехать дальше, либо пересесть. В первом случае он едет с той же
         скоростью, с какой ехал раньше. Если сменить ямщика, он сначала ждет, пока ямщик подготовит сани, и только потом едет с ним
         (с той скоростью, с которой ездит этот ямщик). В пути можно делать сколько угодно пересадок.
      </p>
      <p>Определите, какое время необходимо, чтобы все участники олимпиады доехали из своего города в Москву 300 лет назад. Все участники
         выезжают из своих городов одновременно.
      </p>
   </div>
   <h2>Формат ввода</h2>
   <div class="input-specification"><span style="">
         <p>В первой строке входного файла дано натуральное число N, не превышающее 2000 — количество городов, соединенных дорогами. Город
            с номером 1 является столицей. 
         </p></span><p>Следующие N строк содержат по два целых числа: <span class="tex-math-text">T<sub>i</sub></span> и <span class="tex-math-text">V<sub>i</sub></span> — время подготовки саней в городе i, выраженное в часах, и скорость, с которой ездят ямщики из города i, в километрах в час
         (0 ≤ <span class="tex-math-text">T<sub>i</sub></span> ≤ 100, 1 ≤ <span class="tex-math-text">V<sub>i</sub></span> ≤ 100). 
      </p>
      <p>Следующие N–1 строк содержат описания дорог того времени. Каждое описание состоит из трех чисел <span class="tex-math-text">A<sub>j</sub></span>, <span class="tex-math-text">B<sub>j</sub></span> и <span class="tex-math-text">S<sub>j</sub></span>, где <span class="tex-math-text">A<sub>j</sub></span> и <span class="tex-math-text">B<sub>j</sub></span> — номера соединенных городов, а <span class="tex-math-text">S<sub>j</sub></span> — расстояние между ними в километрах (1 ≤ <span class="tex-math-text">A<sub>j</sub></span> ≤ N, 1 ≤ <span class="tex-math-text">B<sub>j</sub></span> ≤ N, <span class="tex-math-text">A<sub>j</sub></span> ≠ <span class="tex-math-text">B<sub>j</sub></span>, 1 ≤ <span class="tex-math-text">S<sub>j</sub></span> ≤ 10000). Все дороги двусторонние, то есть если из A можно проехать в B, то из B можно проехать в A. Гарантируется, что из
         всех городов можно добраться в столицу.
      </p>
   </div>
   <h2>Формат вывода</h2>
   <div class="output-specification"><span style="">
         <p>Сначала выведите одно вещественное число — время в часах, в которое в Москву приедет последний участник.</p></span><p>Далее выведите путь участника, который приедет самым последним (если таких участников несколько, выведите путь любого из них).
         Выведите город, из которого этот участник выехал первоначально, и перечислите в порядке посещения те города, в которых он
         делал пересадки. Последовательность должна заканчиваться столицей.
      </p>
      <p>При проверке ответ будет засчитан, если из трех величин «время путешествия по выведенному пути», «выведенное время» и «правильный
         ответ» каждые две отличаются менее чем на 0.0001.
      </p>
      <p><span style=""><span style="font-size:LARGE;">Пример 1</span></span></p>
      <p><span style=""><span style="font-size:Large;">Ввод</span></span></p>
      <p>4</p>
      <p>1 1</p>
      <p>10 30</p>
      <p>5 40</p>
      <p>1 10</p>
      <p>1 2 300</p>
      <p>1 3 400</p>
      <p>2 4 100</p>
      <p><span style=""><span style="font-size:Large;">Вывод</span></span></p>
      <p>31.0000000000</p>
      <p>4 2 1</p>
      <p><span style=""><span style="font-size:LARGE;">Пример 2</span></span></p>
      <p><span style=""><span style="font-size:Large;">Ввод</span></span></p>
      <p>3</p>
      <p>1 1</p>
      <p>0 10</p>
      <p>0 55</p>
      <p>1 2 100</p>
      <p>2 3 10</p>
      <p><span style=""><span style="font-size:Large;">Вывод</span></span></p>
      <p>3.0000000000</p>
      <p>2 3 1</p>
   </div>
   <h2>Примечания</h2>
   <div class="notes"><span style="">
         <p>1. Участник из города 1 уже находится на своем месте и тратит на дорогу 0 часов. Участник из города 2 ждет 10 часов ямщика
            в своем городе, а затем проезжает 300 км от города 2 до города 1 за 10 часов, т.е. тратит на дорогу 20 часов. Участник из
            города номер 3 ждет ямщика 5 часов, а затем доезжает до города 1 за 10 часов, т.е. тратит на дорогу 15 часов. Участник из
            города 4 может доехать до города 1 с ямщиком из города 4 за 1 + 40 = 41 час или доехать до города номер 2 за 1 + 10 = 11 часов,
            прождать там 10 и доехать до столицы за 10 часов. Таким образом, он может добраться до города 1 минимум за 31 час. Это и есть
            самое большое время и ответ к задаче.
         </p></span><p>2. Участнику из города 2 выгоднее добраться сначала до третьего города, где ездят быстрее, а потом поехать в столицу, не делая
         пересадки в своём городе.
      </p>
   </div>